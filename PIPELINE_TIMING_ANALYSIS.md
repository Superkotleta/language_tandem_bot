# ‚è±Ô∏è –ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è CI/CD Pipeline

## üìä **–û—Å–Ω–æ–≤–Ω–æ–π CI/CD Pipeline (ci.yml)**

### **üß™ Test Job:**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Setup** | 1-2 –º–∏–Ω | Checkout, Go setup, cache |
| **Install dependencies** | 2-3 –º–∏–Ω | `go work sync` + –º–æ–¥—É–ª–∏ |
| **Linting** | 3-5 –º–∏–Ω | golangci-lint |
| **Unit tests** | 5-8 –º–∏–Ω | –¢–µ—Å—Ç—ã –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ |
| **Integration tests** | 3-5 –º–∏–Ω | E2E —Ç–µ—Å—Ç—ã |
| **Coverage** | 1-2 –º–∏–Ω | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ |
| **Security scan** | 4-6 –º–∏–Ω | Gosec, Trivy, CodeQL |
| **Docker build** | 2-3 –º–∏–Ω | –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞ |

**üéØ –ò—Ç–æ–≥–æ: 21-34 –º–∏–Ω—É—Ç—ã**

### **üê≥ Docker Compose Test:**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Build** | 3-5 –º–∏–Ω | Docker Compose build |
| **Start services** | 2-3 –º–∏–Ω | PostgreSQL, Redis, Bot |
| **Health checks** | 1-2 –º–∏–Ω | –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoints |
| **Cleanup** | 1 –º–∏–Ω | –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ |

**üéØ –ò—Ç–æ–≥–æ: 7-11 –º–∏–Ω—É—Ç**

### **üìä –û–±—â–µ–µ –≤—Ä–µ–º—è CI/CD: 28-45 –º–∏–Ω—É—Ç**

---

## üöÄ **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ Workflows**

### **üì¶ Deploy (deploy.yml):**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Docker build** | 5-8 –º–∏–Ω | Multi-platform build |
| **Push to registry** | 2-3 –º–∏–Ω | Upload –≤ Docker Hub |
| **SSH deploy** | 1-2 –º–∏–Ω | –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä |
| **Health check** | 1 –º–∏–Ω | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ deploy |

**üéØ –ò—Ç–æ–≥–æ: 9-14 –º–∏–Ω—É—Ç**

### **üì± Notifications (notifications.yml):**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Telegram message** | 5-10 —Å–µ–∫ | –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |

**üéØ –ò—Ç–æ–≥–æ: < 1 –º–∏–Ω—É—Ç—ã**

### **üèÉ Performance (performance.yml):**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Setup** | 1-2 –º–∏–Ω | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ |
| **Load testing** | 2-3 –º–∏–Ω | Vegeta + Hey |
| **Profiling** | 3-5 –º–∏–Ω | Memory/CPU –ø—Ä–æ—Ñ–∏–ª–∏ |
| **Reports** | 1 –º–∏–Ω | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ |

**üéØ –ò—Ç–æ–≥–æ: 7-11 –º–∏–Ω—É—Ç**

### **üè∑Ô∏è Release (release.yml):**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Build binaries** | 3-5 –º–∏–Ω | Multi-platform —Å–±–æ—Ä–∫–∞ |
| **Generate changelog** | 1 –º–∏–Ω | Git log –∞–Ω–∞–ª–∏–∑ |
| **Create release** | 1-2 –º–∏–Ω | GitHub Release |

**üéØ –ò—Ç–æ–≥–æ: 5-8 –º–∏–Ω—É—Ç**

### **üîç Monitoring (monitoring.yml):**
| –≠—Ç–∞–ø | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| **Health checks** | 30 —Å–µ–∫ | –ü—Ä–æ–≤–µ—Ä–∫–∞ endpoints |
| **Performance metrics** | 30 —Å–µ–∫ | –°–±–æ—Ä –º–µ—Ç—Ä–∏–∫ |
| **Database check** | 30 —Å–µ–∫ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î |

**üéØ –ò—Ç–æ–≥–æ: 1.5 –º–∏–Ω—É—Ç—ã**

---

## üìà **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏**

### **‚ö° –ë—ã—Å—Ç—Ä—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

1. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ jobs:**
```yaml
# –í–º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
strategy:
  matrix:
    service: [bot, matcher, profile]
```

2. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```yaml
# –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
- name: Cache Go modules
- name: Cache Docker layers
```

3. **–£—Å–ª–æ–≤–Ω—ã–µ –∑–∞–ø—É—Å–∫–∏:**
```yaml
# –¢–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö
if: contains(github.event.head_commit.modified, 'services/bot/')
```

### **üöÄ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

1. **Matrix builds** - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
2. **Dependency caching** - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
3. **Incremental builds** - —Å–±–æ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã—Ö —á–∞—Å—Ç–µ–π
4. **Self-hosted runners** - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–∞—à–∏–Ω—ã –¥–ª—è CI

---

## üéØ **–ò—Ç–æ–≥–æ–≤—ã–µ –≤—Ä–µ–º–µ–Ω–∞**

### **üìä –†–µ–∞–ª—å–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:**

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è | –ß–∞—Å—Ç–æ—Ç–∞ |
|----------|--------|----------|
| **Push –≤ feature branch** | 25-35 –º–∏–Ω | –ö–∞–∂–¥—ã–π –∫–æ–º–º–∏—Ç |
| **Pull Request** | 25-35 –º–∏–Ω | –ö–∞–∂–¥—ã–π PR |
| **Push –≤ main** | 35-50 –º–∏–Ω | –ö–∞–∂–¥—ã–π merge |
| **Release tag** | 15-25 –º–∏–Ω | –ö–∞–∂–¥—ã–π —Ä–µ–ª–∏–∑ |
| **Performance test** | 7-11 –º–∏–Ω | –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ |
| **Monitoring** | 1.5 –º–∏–Ω | –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω |

### **‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞:**

| –°—Ü–µ–Ω–∞—Ä–∏–π | –¢–µ–∫—É—â–µ–µ | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ |
|----------|---------|------------------|
| **Feature branch** | 25-35 –º–∏–Ω | 15-20 –º–∏–Ω |
| **Main branch** | 35-50 –º–∏–Ω | 20-30 –º–∏–Ω |
| **Release** | 15-25 –º–∏–Ω | 8-12 –º–∏–Ω |

---

## üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**

### **üéØ –î–ª—è production:**

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ self-hosted runners** –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ conditional builds** –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏** - –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤
4. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–µ—à–µ–π

### **üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**

- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** –∫–∞–∂–¥–æ–≥–æ job
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** (CPU, –ø–∞–º—è—Ç—å)
- **–ß–∞—Å—Ç–æ—Ç–∞ —Å–±–æ–µ–≤** –∏ –∏—Ö –ø—Ä–∏—á–∏–Ω—ã
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**

**üéØ –¶–µ–ª—å: < 20 –º–∏–Ω—É—Ç –¥–ª—è feature branches, < 30 –º–∏–Ω—É—Ç –¥–ª—è main**
