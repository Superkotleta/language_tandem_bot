# –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–Ω–µ–ª–∏

## 1. –°–∏—Å—Ç–µ–º–∞ —Ä–æ–ª–µ–π –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### 1.1 –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ë–î

–î–æ–±–∞–≤–∏—Ç—å –≤ —Ç–∞–±–ª–∏—Ü—É `users` –ø–æ–ª–µ `role`:

```sql
-- services/deploy/db-init/03-init-users.sql –∏–ª–∏ –Ω–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
ALTER TABLE users ADD COLUMN role TEXT DEFAULT 'user' 
  CHECK (role IN ('user', 'moderator', 'admin'));
CREATE INDEX idx_users_role ON users(role);
```

### 1.2 –û–±–Ω–æ–≤–∏—Ç—å –º–æ–¥–µ–ª—å User

–§–∞–π–ª: `services/bot/internal/models/user.go`

- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `Role string` —Å —Ç–µ–≥–æ–º `db:"role"`

### 1.3 Middleware –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: `services/bot/internal/adapters/telegram/handlers/admin_middleware.go`

- –§—É–Ω–∫—Ü–∏—è `IsAdmin(user *models.User) bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ admin
- –§—É–Ω–∫—Ü–∏—è `IsModerator(user *models.User) bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ moderator/admin
- –§—É–Ω–∫—Ü–∏—è `CheckAdminAccess()` - middleware –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### 1.4 –ù–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞ —á–∏—Ç–∞—Ç—å `ADMIN_USERNAMES` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–∑–Ω–∞—á–∞—Ç—å —Ä–æ–ª—å `admin` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏ –∏—Ö –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ

## 2. –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∞–¥–º–∏–Ω—Å–∫–æ–π –∫–Ω–æ–ø–∫–æ–π

### 2.1 –û–±–Ω–æ–≤–∏—Ç—å CreateMainMenuKeyboard

–§–∞–π–ª: `services/bot/internal/adapters/telegram/handlers/keyboard_helpers.go`

- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `userRole` –≤ —Ñ—É–Ω–∫—Ü–∏—é `CreateMainMenuKeyboard`
- –ü—Ä–∏ —Ä–æ–ª–∏ `admin` –∏–ª–∏ `moderator` –¥–æ–±–∞–≤–ª—è—Ç—å –∫–Ω–æ–ø–∫—É "‚öôÔ∏è –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å" (`admin_panel`)

## 3. –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### 3.1 –°–æ–∑–¥–∞—Ç—å AdminHandler

–§–∞–π–ª: `services/bot/internal/adapters/telegram/handlers/admin_handlers.go`

–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

- `HandleAdminPanel()` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∫–∏
- `HandleAdminStatistics()` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `HandleAdminUsers()` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `HandleAdminFeedback()` - –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–æ–≤
- `HandleAdminAnnouncements()` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—ã–ª–∫–∞–º–∏
- `HandleAdminMatching()` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –ø–æ–¥–±–æ—Ä–∞
- `HandleAdminLogs()` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
- `HandleAdminExport()` - —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### 3.2 –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

–§–∞–π–ª: `services/bot/internal/adapters/telegram/handlers/admin_keyboards.go`

- `CreateAdminPanelKeyboard()` - –≥–ª–∞–≤–Ω–∞—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏
- `CreateAdminUserActionsKeyboard()` - –¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `CreateAdminMatchingKeyboard()` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∏–Ω–≥–æ–º
- –∏ —Ç.–¥.

## 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

### 4.1 –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–§—É–Ω–∫—Ü–∏—è: `HandleAdminUserSearch()`

- Inline-—Ä–µ–∂–∏–º –ø–æ–∏—Å–∫–∞ –ø–æ username/ID/telegram_id
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π (–ø–æ 5-10 –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É)
- —Ç–∞–∫–∂–µ –ø–æ–¥—É–º–∞—Ç—å –ø—Ä–æ –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤ —ç—Ç–æ–π –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–Ω–∞–∑–∞–¥ –∏ –≤–ø–µ—Ä–µ–¥, –≤ –Ω–∞—á–∞–ª–æ, –≤ –∫–æ–Ω–µ—Ü)

### 4.2 –ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è

–§—É–Ω–∫—Ü–∏—è: `HandleAdminViewUserProfile(userID int)`

- –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Å—Ç–∞—Ç—É—Å, —è–∑—ã–∫–∏, –∏–Ω—Ç–µ—Ä–µ—Å—ã, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å
- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π: —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å, –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å

### 4.3 –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è

–§—É–Ω–∫—Ü–∏–∏:

- `HandleAdminChangeUserStatus()` - –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å (active/paused/banned)
- `HandleAdminChangeUserRole()` - –∏–∑–º–µ–Ω–∏—Ç—å —Ä–æ–ª—å (–¥–ª—è super-admin)
- `HandleAdminResetUserProfile()` - —Å–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å

### 4.4 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

–§–∞–π–ª –ë–î: `services/bot/internal/database/admin_queries.go` (—Å–æ–∑–¥–∞—Ç—å)

```sql
-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
SELECT 
  COUNT(*) as total_users,
  COUNT(CASE WHEN status = 'active' THEN 1 END) as active_users,
  COUNT(CASE WHEN profile_completion_level = 100 THEN 1 END) as completed_profiles
FROM users;

-- –ü–æ —è–∑—ã–∫–∞–º
SELECT native_language_code, target_language_code, COUNT(*) 
FROM users GROUP BY native_language_code, target_language_code;
```

## 5. –ü—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–æ–≤

### 5.1 –°–ø–∏—Å–æ–∫ –æ—Ç–∑—ã–≤–æ–≤

–§—É–Ω–∫—Ü–∏—è: `HandleAdminFeedbackList()`

- –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–∑—ã–≤—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –§–∏–ª—å—Ç—Ä—ã: –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ/–≤—Å–µ
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ: user_id, —Ç–µ–∫—Å—Ç (–ø–µ—Ä–≤—ã–µ 100 —Å–∏–º–≤–æ–ª–æ–≤), –¥–∞—Ç–∞

### 5.2 –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –æ—Ç–∑—ã–≤–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminFeedbackDetail(feedbackID int)`

- –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞
- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
- –ö–Ω–æ–ø–∫–∏: –æ—Ç–º–µ—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º, —É–¥–∞–ª–∏—Ç—å

### 5.3 –û–±–Ω–æ–≤–∏—Ç—å –ë–î –º–µ—Ç–æ–¥—ã

–§–∞–π–ª: `services/bot/internal/database/feedback.go` (–µ—Å–ª–∏ –Ω–µ—Ç - —Å–æ–∑–¥–∞—Ç—å)

- `GetAllFeedback(limit, offset, unprocessedOnly bool)`
- `MarkFeedbackAsProcessed(feedbackID int)`

## 6. –°–∏—Å—Ç–µ–º–∞ —Å–æ–±—ã—Ç–∏–π/–∞–Ω–æ–Ω—Å–æ–≤

### 6.1 –ù–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤ –ë–î

```sql
CREATE TABLE announcements (
  id SERIAL PRIMARY KEY,
  title TEXT NOT NULL,
  message TEXT NOT NULL,
  created_by INT REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  scheduled_at TIMESTAMP,
  sent_at TIMESTAMP,
  status TEXT DEFAULT 'draft' CHECK (status IN ('draft', 'scheduled', 'sending', 'sent', 'cancelled')),
  target_filters JSONB, -- {"languages": ["ru", "en"], "status": ["active"], ...}
  recipients_count INT DEFAULT 0,
  sent_count INT DEFAULT 0
);
```

### 6.2 –°–æ–∑–¥–∞–Ω–∏–µ –∞–Ω–æ–Ω—Å–∞

–§—É–Ω–∫—Ü–∏–∏:

- `HandleAdminCreateAnnouncement()` - –Ω–∞—á–∞—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ
- `HandleAdminAnnouncementTitle()` - –≤–≤–µ—Å—Ç–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ (—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- `HandleAdminAnnouncementMessage()` - –≤–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç (—Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- `HandleAdminAnnouncementTargeting()` - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
  - –í—ã–±–æ—Ä —è–∑—ã–∫–æ–≤ (–º—É–ª—å—Ç–∏–≤—ã–±–æ—Ä) (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ + —Ä–∞—Å—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–º —è–∑—ã–∫–µ –∫–æ—Ç–æ—Ä—ã–π –≤—ã–±—Ä–∞–Ω —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ)
  - –í—ã–±–æ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
  - –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
  - –í—ã–±–æ—Ä –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### 6.3 –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnnouncementPreview()`

- –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç –∞–Ω–æ–Ω—Å–∞
- –ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π (SELECT COUNT —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
- –ö–Ω–æ–ø–∫–∏: –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–µ–π—á–∞—Å / –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å / —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å / –æ—Ç–º–µ–Ω–∏—Ç—å

### 6.4 –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnnouncementSchedule()`

- –í—ã–±–æ—Ä –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `scheduled`

### 6.5 –û—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏

–§—É–Ω–∫—Ü–∏—è: `HandleAdminSendAnnouncement(announcementID int)`

- –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ `sending`
- –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–∞–∂–¥–æ–º—É (—Å rate limiting)
- –û–±–Ω–æ–≤–∏—Ç—å `sent_count` –∏ `sent_at`
- –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –Ω–∞ `sent`

### 6.6 –ò—Å—Ç–æ—Ä–∏—è –∞–Ω–æ–Ω—Å–æ–≤

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnnouncementHistory()`

- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–Ω–æ–Ω—Å–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –∑–∞–≥–æ–ª–æ–≤–æ–∫, —Å—Ç–∞—Ç—É—Å, –¥–∞—Ç–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö
- –ö–Ω–æ–ø–∫–∏: –ø—Ä–æ—Å–º–æ—Ç—Ä / –ø–æ–≤—Ç–æ—Ä–∏—Ç—å / —É–¥–∞–ª–∏—Ç—å

## 7. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º –ø–æ–¥–±–æ—Ä–∞

### 7.1 –ó–∞–ø—É—Å–∫ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminRunMatchingPreview()`

- –í—ã–∑–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –º–∞—Ç—á–∏–Ω–≥–∞ (–ª–∏–±–æ —á–µ—Ä–µ–∑ gRPC –∫ matcher service, –ª–∏–±–æ –Ω–∞–ø—Ä—è–º—É—é –≤ –ë–î)
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ `match_queue` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `pending`
- –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π, —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### 7.2 –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

–§—É–Ω–∫—Ü–∏—è: `HandleAdminViewPendingMatches()`

- –°–ø–∏—Å–æ–∫ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –≤ —Å—Ç–∞—Ç—É—Å–µ `pending` —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ: user1, user2, –±–∞–ª–ª —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –ö–Ω–æ–ø–∫–∏: –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª–∏ / –æ–¥–æ–±—Ä–∏—Ç—å / –æ—Ç–∫–ª–æ–Ω–∏—Ç—å

### 7.3 –î–µ—Ç–∞–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è

–§—É–Ω–∫—Ü–∏—è: `HandleAdminMatchDetails(matchID int)`

- –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –æ–±–æ–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
- –ö–Ω–æ–ø–∫–∏: –æ–¥–æ–±—Ä–∏—Ç—å / –æ—Ç–∫–ª–æ–Ω–∏—Ç—å

### 7.4 –¢–µ—Å—Ç–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminSendTestMatches()`

- –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è —Ç–µ—Å—Ç–∞ (5, 10, 20)
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–∞—Ä–∞–º
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `sent` —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–∏—Ö

### 7.5 –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

–§—É–Ω–∫—Ü–∏—è: `HandleAdminSendAllMatches()`

- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤—Å–µ–º –ø–∞—Ä–∞–º –≤ —Å—Ç–∞—Ç—É—Å–µ `pending`
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ `sent`

### 7.6 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é

–§—É–Ω–∫—Ü–∏–∏:

- `HandleAdminClearMatchQueue()` - –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ pending
- `HandleAdminCancelMatch(matchID)` - –æ—Ç–º–µ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
- `HandleAdminResendMatch(matchID)` - –ø–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å

## 8. –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

### 8.1 –°–∏—Å—Ç–µ–º–Ω—ã–µ –ª–æ–≥–∏

–§—É–Ω–∫—Ü–∏—è: `HandleAdminViewLogs()`

- –ß—Ç–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N —Å—Ç—Ä–æ–∫ –∏–∑ –ª–æ–≥-—Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –ò–ª–∏ –≤—ã–±–æ—Ä–∫–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –ª–æ–≥–æ–≤ (–µ—Å–ª–∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ –ë–î)
- –§–∏–ª—å—Ç—Ä—ã –ø–æ —É—Ä–æ–≤–Ω—é: ERROR, WARN, INFO

### 8.2 –õ–æ–≥–∏ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

–°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É:

```sql
CREATE TABLE admin_action_logs (
  id SERIAL PRIMARY KEY,
  admin_id INT REFERENCES users(id),
  action TEXT NOT NULL, -- 'send_announcement', 'block_user', etc.
  target_type TEXT, -- 'user', 'announcement', 'match'
  target_id INT,
  details JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);
```

–§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `LogAdminAction(adminID, action, targetType, targetID, details)`

## 10. –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

### 10.1 –≠–∫—Å–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–§—É–Ω–∫—Ü–∏—è: `HandleAdminExportUsers()`

- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è CSV —Å –ø–æ–ª—è–º–∏: id, username, status, languages, registration_date
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –≤ —á–∞—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

### 10.2 –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

–§—É–Ω–∫—Ü–∏—è: `HandleAdminExportStats()`

- JSON —Å –æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –º–∞—Ç—á–∏, –æ—Ç–∑—ã–≤—ã
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–∞–º/—è–∑—ã–∫–∞–º

### 10.3 –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç–∑—ã–≤–æ–≤

–§—É–Ω–∫—Ü–∏—è: `HandleAdminExportFeedback()`

- CSV —Å –æ—Ç–∑—ã–≤–∞–º–∏: user_id, text, date, is_processed

## 11. –ü–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### 11.1 –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–æ–≤

–§—É–Ω–∫—Ü–∏—è: `HandleAdminMonitoring()`

–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å:

- Redis: —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (‚úÖ –ø–æ–¥–∫–ª—é—á–µ–Ω / ‚ùå –æ—à–∏–±–∫–∞), –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª—é—á–µ–π –≤ –∫—ç—à–µ
- –ë–î: —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –º–∞–∫—Å–∏–º—É–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- Circuit Breaker —Å–æ—Å—Ç–æ—è–Ω–∏—è: Telegram API, Database, Redis
- Uptime –±–æ—Ç–∞ (–≤—Ä–µ–º—è —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—É—Å–∫–∞)

### 11.2 –ë–∞–∑–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç—É –∂–µ –ø–∞–Ω–µ–ª—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:

- –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π / –∞–∫—Ç–∏–≤–Ω—ã—Ö / –Ω–æ–≤—ã—Ö –∑–∞ –Ω–µ–¥–µ–ª—é
- –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π (100%) / –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ
- Pending –º–∞—Ç—á–µ–π –≤ –æ—á–µ—Ä–µ–¥–∏
- –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
- –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–Ω–æ–Ω—Å–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü

### 11.3 –ë–î –º–µ—Ç–æ–¥—ã

–§–∞–π–ª: `services/bot/internal/database/monitoring.go` (—Å–æ–∑–¥–∞—Ç—å)

- `GetRedisStats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Redis
- `GetDatabaseStats()` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–î
- `GetSystemStats()` - –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

## 12. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### 12.1 –í–æ—Ä–æ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnalyticsFunnel()`

```sql
SELECT 
  COUNT(*) as total_registered,
  COUNT(CASE WHEN profile_completion_level > 0 THEN 1 END) as started_profile,
  COUNT(CASE WHEN profile_completion_level = 100 THEN 1 END) as completed_profile,
  COUNT(CASE WHEN id IN (SELECT user1_id FROM match_queue WHERE status='sent') THEN 1 END) as received_match
FROM users;
```

–û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤ –≤–∏–¥–µ:

```shell
üìä –í–æ—Ä–æ–Ω–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:
üë• –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å: 450
üìù –ù–∞—á–∞–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å: 380 (84%)
‚úÖ –ó–∞–≤–µ—Ä—à–∏–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å: 320 (71%)
ü§ù –ü–æ–ª—É—á–∏–ª–∏ –º–∞—Ç—á: 180 (40%)
```

### 12.2 –ü–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnalyticsInterests()`

```sql
SELECT i.name, COUNT(*) as count, 
  COUNT(CASE WHEN ui.is_primary THEN 1 END) as primary_count
FROM user_interests ui
JOIN interests i ON ui.interest_id = i.id
GROUP BY i.id, i.name
ORDER BY count DESC
LIMIT 10;
```

### 12.3 –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnalyticsActivity()`

```sql
SELECT 
  EXTRACT(DOW FROM created_at) as day_of_week,
  EXTRACT(HOUR FROM created_at) as hour,
  COUNT(*) 
FROM users 
WHERE created_at > NOW() - INTERVAL '30 days'
GROUP BY day_of_week, hour;
```

–£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: —Ç–æ–ø-5 —á–∞—Å–æ–≤ –ø–æ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### 12.4 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∞—Ç—á–∏–Ω–≥–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminAnalyticsMatching()`

- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –¥–æ –ø–µ—Ä–≤–æ–≥–æ –º–∞—Ç—á–∞
- –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–ª —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –≤ —É—Å–ø–µ—à–Ω—ã—Ö –º–∞—Ç—á–∞—Ö
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–∞—Ç—á–µ–π –ø–æ —è–∑—ã–∫–æ–≤—ã–º –ø–∞—Ä–∞–º

### 12.5 –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –ø–æ –∑–∞–ø—Ä–æ—Å—É

–§—É–Ω–∫—Ü–∏—è: `HandleAdminGenerateReport()`

–°–æ–±—Ä–∞—Ç—å –≤—Å–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –æ–¥–∏–Ω –æ—Ç—á–µ—Ç:

- –í—ã–±–æ—Ä –ø–µ—Ä–∏–æ–¥–∞ (–Ω–µ–¥–µ–ª—è, –º–µ—Å—è—Ü, –≤—Å–µ –≤—Ä–µ–º—è)
- –§–æ—Ä–º–∞—Ç: —Ç–µ–∫—Å—Ç –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –∏–ª–∏ CSV —Ñ–∞–π–ª
- –í–∫–ª—é—á–∞–µ—Ç: –≤–æ—Ä–æ–Ω–∫—É, –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –º–∞—Ç—á–∏–Ω–≥–∞

## 13. –ê—É–¥–∏—Ç –∏ –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 13.1 –¢–∞–±–ª–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π

```sql
CREATE TABLE user_profile_history (
  id SERIAL PRIMARY KEY,
  user_id INT REFERENCES users(id) ON DELETE CASCADE,
  changed_by INT REFERENCES users(id), -- NULL –µ—Å–ª–∏ —Å–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  field_name TEXT NOT NULL,
  old_value TEXT,
  new_value TEXT,
  change_reason TEXT, -- –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç –∞–¥–º–∏–Ω–∞
  changed_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_user_profile_history_user ON user_profile_history(user_id);
CREATE INDEX idx_user_profile_history_changed_by ON user_profile_history(changed_by);
```

### 13.2 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

–°–æ–∑–¥–∞—Ç—å helper-—Ñ—É–Ω–∫—Ü–∏—é: `LogProfileChange(userID, changedBy, field, oldVal, newVal, reason)`

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã –≤:

- `HandleAdminChangeUserStatus()`
- `HandleAdminChangeUserRole()`
- `HandleAdminBlockUser()`
- –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è –∞–¥–º–∏–Ω–æ–º

### 13.3 –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏

–§—É–Ω–∫—Ü–∏—è: `HandleAdminViewUserHistory(userID)`

- –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20 –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –¥–∞—Ç–∞, –∫—Ç–æ –∏–∑–º–µ–Ω–∏–ª, —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª, —Å—Ç–∞—Ä–æ–µ ‚Üí –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–Ω–æ–≥–æ

### 13.4 –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminViewAdminActions(adminID)`

- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ò–∑ —Ç–∞–±–ª–∏—Ü: `admin_action_logs` + `user_profile_history`
- –° —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –¥–∞—Ç–∞–º

## 14. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ batch –æ–ø–µ—Ä–∞—Ü–∏–∏

### 14.1 –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

```sql
CREATE TABLE automation_settings (
  id SERIAL PRIMARY KEY,
  task_name TEXT UNIQUE NOT NULL, -- 'auto_pause_inactive', 'auto_send_reminders'
  is_enabled BOOLEAN DEFAULT FALSE,
  config JSONB, -- {"days_threshold": 30, "check_interval": "daily"}
  last_run TIMESTAMP,
  next_run TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### 14.2 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–∞—É–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã—Ö

–§—É–Ω–∫—Ü–∏—è: `RunAutoPauseInactive()`

```sql
UPDATE users 
SET status = 'paused', updated_at = NOW()
WHERE status = 'active' 
  AND updated_at < NOW() - INTERVAL '30 days'
  AND id NOT IN (SELECT user1_id FROM match_queue WHERE created_at > NOW() - INTERVAL '30 days');
```

–õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤ `admin_action_logs` –∫–∞–∫ —Å–∏—Å—Ç–µ–º–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ (admin_id = NULL –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π system user)

### 14.3 –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

–§—É–Ω–∫—Ü–∏—è: `RunAutoSendReminders()`

```sql
SELECT id, telegram_id, interface_language_code 
FROM users 
WHERE profile_completion_level < 100 
  AND profile_completion_level > 0
  AND created_at < NOW() - INTERVAL '7 days'
  AND updated_at < NOW() - INTERVAL '3 days';
```

–û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –∫–∞–∂–¥–æ–º—É

### 14.4 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–µ–π —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

–§—É–Ω–∫—Ü–∏–∏:

- `HandleAdminAutomationSettings()` - –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å
- `HandleAdminToggleAutomation(taskName)` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∑–∞–¥–∞—á—É
- `HandleAdminRunAutomationNow(taskName)` - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –≤—Ä—É—á–Ω—É—é –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å
- `HandleAdminConfigureAutomation(taskName)` - –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Ä–æ–≥ –¥–Ω–µ–π)

### 14.5 –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –≤ –∫–æ–¥–µ –±–æ—Ç–∞

–§–∞–π–ª: `services/bot/internal/automation/scheduler.go` (—Å–æ–∑–¥–∞—Ç—å)

- Goroutine, –∫–æ—Ç–æ—Ä–∞—è –∫–∞–∂–¥—ã–µ N –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `automation_settings`
- –ï—Å–ª–∏ `is_enabled=true` –∏ `next_run <= NOW()`, –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é –∑–∞–¥–∞—á—É
- –û–±–Ω–æ–≤–ª—è–µ—Ç `last_run` –∏ `next_run` –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫ –≤ `main.go` –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞

### 14.6 –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–Ω—Å–æ–≤

–ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ, –æ—Ç–¥–µ–ª—å–Ω–∞—è goroutine –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É `announcements`:

```sql
SELECT * FROM announcements 
WHERE status = 'scheduled' 
  AND scheduled_at <= NOW();
```

–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å –Ω–∞ `sent`

## 15. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### 15.1 –¢–∞–±–ª–∏—Ü–∞ –¥–ª—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –±—ç–∫–∞–ø–æ–≤

```sql
CREATE TABLE backups (
  id SERIAL PRIMARY KEY,
  filename TEXT NOT NULL,
  file_path TEXT, -- –µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ
  file_size BIGINT, -- —Ä–∞–∑–º–µ—Ä –≤ –±–∞–π—Ç–∞—Ö
  created_by INT REFERENCES users(id),
  created_at TIMESTAMP DEFAULT NOW(),
  backup_type TEXT DEFAULT 'full' CHECK (backup_type IN ('full', 'users_only', 'feedback_only')),
  status TEXT DEFAULT 'completed' CHECK (status IN ('in_progress', 'completed', 'failed'))
);
```

### 15.2 –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminCreateBackup(backupType)`

```go
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pg_dump —á–µ—Ä–µ–∑ exec.Command
cmd := exec.Command("pg_dump", "-h", dbHost, "-U", dbUser, "-d", dbName, "-f", filename)
```

- –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å "‚è≥ –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞..."
- –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –∞–¥–º–∏–Ω—É –≤ —á–∞—Ç
- –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü—É `backups`
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –Ω–∞ –¥–∏—Å–∫–µ (configurable –ø—É—Ç—å)

### 15.3 –°–ø–∏—Å–æ–∫ –±—ç–∫–∞–ø–æ–≤

–§—É–Ω–∫—Ü–∏—è: `HandleAdminListBackups()`

```sql
SELECT id, filename, file_size, created_by, created_at, backup_type
FROM backups
ORDER BY created_at DESC
LIMIT 10;
```

–û—Ç–æ–±—Ä–∞–∑–∏—Ç—å:

```shell
üì¶ –ü–æ—Å–ª–µ–¥–Ω–∏–µ –±—ç–∫–∞–ø—ã:

1. full_backup_2025-10-21_14-30.sql
   –†–∞–∑–º–µ—Ä: 15.3 MB
   –°–æ–∑–¥–∞–ª: @admin_user
   –î–∞—Ç–∞: 21.10.2025 14:30
   [üì• –°–∫–∞—á–∞—Ç—å] [üóë –£–¥–∞–ª–∏—Ç—å]

2. ...
```

### 15.4 –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminDownloadBackup(backupID)`

- –ù–∞–π—Ç–∏ —Ñ–∞–π–ª –ø–æ `file_path` –∏–∑ –ë–î
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ —á–∞—Ç –∞–¥–º–∏–Ω—É
- –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∞ –¥–∏—Å–∫–µ - —Å–æ–æ–±—â–∏—Ç—å –æ–± –æ—à–∏–±–∫–µ

### 15.5 –£–¥–∞–ª–µ–Ω–∏–µ –±—ç–∫–∞–ø–∞

–§—É–Ω–∫—Ü–∏—è: `HandleAdminDeleteBackup(backupID)`

- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è
- –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª —Å –¥–∏—Å–∫–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ –ë–î

## 16. –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏

### 16.1 Breadcrumbs —Å–∏—Å—Ç–µ–º–∞

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª: `services/bot/internal/adapters/telegram/handlers/navigation.go`

```go
type Breadcrumb struct {
  Title    string
  Callback string // –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–Ω–∞–∑–∞–¥" 
}

type NavigationStack struct {
  UserID      int64
  Breadcrumbs []Breadcrumb
  UpdatedAt   time.Time
}
```

–•—Ä–∞–Ω–∏—Ç—å —Å—Ç–µ–∫ –≤ –ø–∞–º—è—Ç–∏ (–∏–ª–∏ Redis –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏):

```go
var navigationStacks = make(map[int64]*NavigationStack)
```

### 16.2 Helper —Ñ—É–Ω–∫—Ü–∏–∏

- `PushBreadcrumb(userID, title, callback)` - –¥–æ–±–∞–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å
- `PopBreadcrumb(userID)` - –≤–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞–∑–∞–¥
- `GetBreadcrumbPath(userID)` - –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—É—Ç—å –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `ClearBreadcrumbs(userID)` - –æ—á–∏—Å—Ç–∏—Ç—å –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

### 16.3 –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å–æ–æ–±—â–µ–Ω–∏—è

Wrapper-—Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö –∞–¥–º–∏–Ω—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:

```go
func SendAdminMessage(chatID int64, userID int64, text string, keyboard interface{}) {
  breadcrumbPath := GetBreadcrumbPath(userID)
  fullText := fmt.Sprintf("üìç %s\n\n%s", breadcrumbPath, text)
  
  // –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "‚óÄÔ∏è –ù–∞–∑–∞–¥" –∫ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ
  keyboardWithBack := AddBackButton(keyboard, userID)
  
  // –û—Ç–ø—Ä–∞–≤–∏—Ç—å
  SendMessage(chatID, fullText, keyboardWithBack)
}
```

### 16.4 –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

- –ù–∞ –ø–µ—Ä–≤–æ–º —ç—Ç–∞–ø–µ: –≤–Ω–µ–¥—Ä–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Ç–æ–ª—å–∫–æ –¥–ª—è –ù–û–í–´–• –∞–¥–º–∏–Ω—Å–∫–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–Ω–æ–ø–∫–∏/–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Å–ª–æ–∂–Ω—ã–µ –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –º–µ–Ω—é (–∞–Ω–æ–Ω—Å—ã, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∏–Ω–≥–æ–º)

### 16.5 –ö–Ω–æ–ø–∫–∞ "–í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é"

–ù–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö –∞–¥–º–∏–Ω–∫–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è—Ç—å –∫–Ω–æ–ø–∫—É:

```shell
üè† –í –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–¥–º–∏–Ω–∫–∏
```

Callback: `admin_panel` (–≤–æ–∑–≤—Ä–∞—Ç –≤ –≥–ª–∞–≤–Ω—É—é –∞–¥–º–∏–Ω–∫—É)

## 17. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### 17.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (–Ω–∞ –±—É–¥—É—â–µ–µ)

–¢–∞–±–ª–∏—Ü–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```sql
CREATE TABLE matching_config (
  id SERIAL PRIMARY KEY,
  name TEXT UNIQUE NOT NULL,
  primary_interest_score INT,
  additional_interest_score INT,
  min_compatibility_score INT,
  is_active BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW()
);
```

### 17.2 –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ Dashboard

–§—É–Ω–∫—Ü–∏—è: `HandleAdminDashboard()`

–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω –∞–¥–º–∏–Ω–∫–∏ —Å –∫—Ä–∞—Ç–∫–∏–º –æ–±–∑–æ—Ä–æ–º:

- –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞: –≤—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∞–∫—Ç–∏–≤–Ω—ã—Ö, –Ω–æ–≤—ã—Ö –∑–∞ –Ω–µ–¥–µ–ª—é
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ pending –º–∞—Ç—á–µ–π
- –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
- –ë—ã—Å—Ç—Ä—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã

## 18. –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–≤ "—è—â–∏–∫")

–ò–¥–µ–∏ –¥–ª—è –±—É–¥—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º —á–µ—Ä–µ–∑ –ë–î** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. **Webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏** - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ Slack/Discord/–≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
3. **–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π** - —É–º–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
4. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É (–æ–ø–∞—Å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

## 19. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Router

–§–∞–π–ª: `services/bot/internal/adapters/telegram/router.go` (–∏–ª–∏ –≥–¥–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è callback)

- –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö callback-–∫–æ–º–∞–Ω–¥: `admin_*`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º

## 20. –°–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ `services/bot/internal/models/user.go`:

```go
const (
  StateAdminAnnouncementTitle = "admin_announcement_title"
  StateAdminAnnouncementMessage = "admin_announcement_message"
  StateAdminUserSearch = "admin_user_search"
  // ...
)
```

## 21. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã —Ç–µ—Å—Ç–æ–≤:

- `services/bot/internal/adapters/telegram/handlers/admin_handlers_test.go`
- `services/bot/internal/database/admin_queries_test.go`

–ü–æ–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏:

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞–Ω–æ–Ω—Å–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ç—á–∞–º–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
