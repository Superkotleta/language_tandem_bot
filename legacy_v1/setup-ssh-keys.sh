#!/bin/bash

# ðŸ” Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ SSH ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð´Ð»Ñ GitHub Actions

echo "ðŸ” ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° SSH ÐºÐ»ÑŽÑ‡ÐµÐ¹ Ð´Ð»Ñ GitHub Actions"
echo "=========================================="

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð´Ð»Ñ ÐºÐ»ÑŽÑ‡ÐµÐ¹
mkdir -p ~/.ssh/github-actions
cd ~/.ssh/github-actions

# Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ SSH ÐºÐ»ÑŽÑ‡
echo "ðŸ“ Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÐ¼ SSH ÐºÐ»ÑŽÑ‡ Ð´Ð»Ñ GitHub Actions..."
ssh-keygen -t ed25519 -C "github-actions-$(date +%Y%m%d)" -f github_actions -N ""

echo ""
echo "âœ… SSH ÐºÐ»ÑŽÑ‡ ÑÐ¾Ð·Ð´Ð°Ð½!"
echo ""

# ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡
echo "ðŸ“‹ ÐŸÐ£Ð‘Ð›Ð˜Ð§ÐÐ«Ð™ ÐºÐ»ÑŽÑ‡ (Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€):"
echo "========================================"
cat github_actions.pub
echo ""

# ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡
echo "ðŸ”’ ÐŸÐ Ð˜Ð’ÐÐ¢ÐÐ«Ð™ ÐºÐ»ÑŽÑ‡ (Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð² GitHub Secrets ÐºÐ°Ðº SERVER_SSH_KEY):"
echo "=================================================================="
cat github_actions
echo ""

echo "ðŸ“‹ Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ð¸:"
echo "=============="
echo "1. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÐŸÐ£Ð‘Ð›Ð˜Ð§ÐÐ«Ð™ ÐºÐ»ÑŽÑ‡ Ð²Ñ‹ÑˆÐµ Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð½Ð° Ð²Ð°Ñˆ ÑÐµÑ€Ð²ÐµÑ€:"
echo "   ssh-copy-id -i ~/.ssh/github-actions/github_actions.pub user@your-server.com"
echo ""
echo "2. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÐŸÐ Ð˜Ð’ÐÐ¢ÐÐ«Ð™ ÐºÐ»ÑŽÑ‡ Ð²Ñ‹ÑˆÐµ Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð² GitHub Secrets:"
echo "   - ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ: SERVER_SSH_KEY"
echo "   - Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: (Ð²ÐµÑÑŒ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡)"
echo ""
echo "3. Ð”Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð¾ÑÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ secrets ÑÐ¾Ð³Ð»Ð°ÑÐ½Ð¾ SETUP_SECRETS_GUIDE.md"
echo ""
echo "4. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ñ‚ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ workflow: .github/workflows/test-secrets.yml"
echo ""

# Ð¡Ð¾Ð·Ð´Ð°ÐµÐ¼ Ñ„Ð°Ð¹Ð» Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÐ¼Ð¸
cat > ~/.ssh/github-actions/README.md << 'EOF'
# ðŸ” GitHub Actions SSH Keys

## ðŸ“ Ð¤Ð°Ð¹Ð»Ñ‹:
- `github_actions` - ÐŸÐ Ð˜Ð’ÐÐ¢ÐÐ«Ð™ ÐºÐ»ÑŽÑ‡ (Ð´Ð»Ñ GitHub Secrets)
- `github_actions.pub` - ÐŸÐ£Ð‘Ð›Ð˜Ð§ÐÐ«Ð™ ÐºÐ»ÑŽÑ‡ (Ð´Ð»Ñ ÑÐµÑ€Ð²ÐµÑ€Ð°)

## ðŸš€ Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ:

### 1. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€:
```bash
ssh-copy-id -i github_actions.pub user@your-server.com
```

### 2. Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ð¹ ÐºÐ»ÑŽÑ‡ Ð² GitHub Secrets:
- ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ: `SERVER_SSH_KEY`
- Ð—Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ: ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ Ñ„Ð°Ð¹Ð»Ð° `github_actions`

### 3. Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ:
```bash
ssh -i github_actions user@your-server.com
```

## âš ï¸ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ:
- ÐÐ¸ÐºÐ¾Ð³Ð´Ð° Ð½Ðµ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚ÑŒÑ‚Ðµ Ð¿Ñ€Ð¸Ð²Ð°Ñ‚Ð½Ñ‹Ðµ ÐºÐ»ÑŽÑ‡Ð¸!
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ GitHub Secrets
- Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ð¾ Ñ€Ð¾Ñ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÐºÐ»ÑŽÑ‡Ð¸
EOF

echo "ðŸ“„ Ð¡Ð¾Ð·Ð´Ð°Ð½ Ñ„Ð°Ð¹Ð» Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÐ¼Ð¸: ~/.ssh/github-actions/README.md"
echo ""
echo "ðŸŽ¯ Ð“Ð¾Ñ‚Ð¾Ð²Ð¾! Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹Ñ‚Ðµ secrets Ð² GitHub."
